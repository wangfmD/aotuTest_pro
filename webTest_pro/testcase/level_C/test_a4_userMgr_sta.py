# coding=utf-8import sysimport unittestfrom time import sleepfrom selenium import webdriverfrom selenium.common.exceptions import NoAlertPresentException, NoSuchElementExceptionfrom _env import addPathsaddPaths('.')from common.init import execEnv, loginInfofrom model.baseActionAdd import user_login, add_usersfrom model.baseActionDel import del_userfrom  model.baseActionSearch import search_userfrom  model.baseActionModify import update_Userreload(sys)sys.setdefaultencoding("utf-8")users = [{'loginName': 'auser', 'trueName': 'ateacher'},         {'loginName': 'buser1', 'trueName': 'bteacher1'},         {'loginName': 'cuser2', 'trueName': 'cteacher2'},         {'loginName': 'duser3', 'trueName': 'dteacher3'},         {'loginName': 'euser4', 'trueName': 'eteacher4'}]usersData = [{'mobiles': '18551184502', 'emails': '9930356@qq.com','trueName':u'张三','searchName':u'cteacher2'}]class userlist(unittest.TestCase):    ''''用户管理'''    def setUp(self):        if execEnv['execType'] == 'local':            print "\n", "=" * 20, "local exec testcase", "=" * 19            self.driver = webdriver.Chrome()            self.driver.implicitly_wait(8)            self.verificationErrors = []            self.accept_next_alert = True            print "start tenantmanger..."        else:            print "\n", "=" * 20, "remote exec testcase", "=" * 18            browser = webdriver.DesiredCapabilities.CHROME            self.driver = webdriver.Remote(command_executor=execEnv['remoteUrl'], desired_capabilities=browser)            self.driver.implicitly_wait(8)            self.verificationErrors = []            self.accept_next_alert = True            print "start tenantmanger..."    def tearDown(self):        self.driver.quit()        self.assertEqual([], self.verificationErrors)        print "schoolmanager end!"        print "=" * 60    def test_add_user(self):        '''添加用户'''        print "exec：test_add_user..."        driver = self.driver        user_login(driver, **loginInfo)        for user in users:            add_users(driver, **user)            self.assertEqual(u"添加成功！", driver.find_element_by_css_selector(".layui-layer-content").text)        sleep(0.5)        print "exec：test_add_user success."    def test_bsearch_user(self):        '''查询用户信息'''        print "exec：test_search_user"        driver = self.driver        user_login(driver, **loginInfo)        for user in users:            search_user(driver, **user)            self.assertEqual(user['loginName'],                             driver.find_element_by_xpath("//tbody[@id='userlists']/tr/td[3]").text)        print "exec: test_search_user success."        sleep(0.5)    def test_bupdate_user(self):        '''修改用户信息'''        print "exec：test_search_user"        driver = self.driver        user_login(driver, **loginInfo)        for itms in usersData:            update_User(driver,**itms)        print "exec: test_bupdate_user success."        sleep(0.5)    def test_del_user_ok(self):        '''删除用户_确定'''        print "exec：test_del_user_ok..."        driver = self.driver        user_login(driver, **loginInfo)        for user in users:            del_user(driver)            self.assertEqual(u"删除成功！", driver.find_element_by_css_selector(".layui-layer-content").text)            sleep(0.5)        print "exec：test_del_user_ok success."    def is_element_present(self, how, what):        try:            self.driver.find_element(by=how, value=what)        except NoSuchElementException as e:            return False        return True    def is_alert_present(self):        try:            self.driver.switch_to_alert()        except NoAlertPresentException as e:            return False        return True    def close_alert_and_get_its_text(self):        try:            alert = self.driver.switch_to_alert()            alert_text = alert.text            if self.accept_next_alert:                alert.accept()            else:                alert.dismiss()            return alert_text        finally:            self.accept_next_alert = Trueif __name__ == '__main__':    unittest.main()